# PCIe设备伪装工具增强版

## 软件简介

PCIe设备伪装工具是一款用于创建和配置PCIe设备伪装代码的图形界面工具，适用于FPGA开发和安全研究。
本工具可以帮助用户轻松创建各种PCIe设备的伪装配置，生成相应的硬件描述语言代码，用于在FPGA上实现设备伪装。

## 系统要求

- 操作系统：Windows 7/10/11或Linux
- Python 3.6或更高版本
- 已安装Python的tkinter库（通常随Python安装包一起安装）

## 启动方法

1. 双击"启动.bat"文件，程序将自动检查环境并启动
2. 如果没有安装Python或环境变量设置不正确，程序会提示您安装Python

## 使用流程

### 1. 创建新配置

- 在"新建配置"选项卡中，选择设备类型（标准设备或自定义设备）
- 如果选择标准设备，可以从预设列表中选择设备模板（如Atheros无线网卡、Intel网卡等）
- 如果选择自定义设备，需要填写以下信息：
  - 设备名称
  - 供应商ID（Vendor ID，4位十六进制）
  - 设备ID（Device ID，4位十六进制）
  - 类代码（Class Code，6位十六进制）
  - 设备描述（可选）
- 点击"创建配置"按钮完成创建

### 2. 加载现有配置

- 在"现有配置"选项卡中，点击"浏览"按钮选择配置文件
- 点击"加载配置"按钮加载选择的配置文件
- 加载后，配置信息会显示在预览区域

### 3. 高级编辑（如果可用）

- **寄存器编辑器**：添加、编辑和删除设备寄存器及位域
  - 点击"添加寄存器"创建新寄存器
  - 设置寄存器地址、大小、访问权限等
  - 添加寄存器位域，定义每个位的功能
- **DMA编辑器**：配置DMA控制器参数
  - 设置DMA类型、描述符格式、队列深度等
  - 定义DMA寄存器和控制参数
- **中断编辑器**：配置设备中断系统
  - 选择中断模式（传统中断、MSI、MSI-X）
  - 定义中断向量和触发事件

### 4. 生成代码

- 在"代码生成"选项卡中，选择需要生成的代码类型：
  - 配置空间代码
  - BAR空间代码
  - DMA控制器代码
  - 中断处理代码
  - 设备行为代码
  - 测试代码
- 设置相关生成选项
- 点击"生成代码"按钮
- 选择保存位置，生成的代码将保存到指定目录

### 5. 保存配置

- 在"文件"菜单中选择"保存配置"或"另存为"
- 选择保存位置并确认

## 功能说明

### 1. 菜单栏功能

- 文件：新建、打开、保存、导出和退出
- 编辑：复制、粘贴和编辑器选项
- 视图：切换不同视图模式
- 帮助：查看帮助文档和关于信息

### 2. 寄存器编辑

- 支持添加多种类型的寄存器：控制、状态、ID、配置等
- 可定义寄存器的读写权限和复位值
- 支持位域定义，可精确控制每个位的功能

### 3. DMA配置

- 支持多种DMA模式：简单DMA、描述符DMA、分散-聚集DMA
- 可配置DMA队列深度和描述符格式
- 支持定义DMA中断触发条件

### 4. 中断系统

- 支持传统中断、MSI和MSI-X中断模式
- 可配置中断向量数量和优先级
- 支持定义中断触发事件和应答机制

### 5. 可视化视图（如果可用）

- 寄存器映射视图：直观展示寄存器内存布局
- 设备结构视图：展示设备内部组件结构

## 注意事项

1. 生成代码前请确保所有必要参数已正确设置
2. 对于复杂设备，建议先创建基本配置，再逐步添加高级功能
3. 保存配置文件时使用有意义的文件名，便于日后识别
4. 生成的代码可能需要根据目标FPGA平台进行微调
5. 对于预设设备，建议查阅PCIe设备完全伪装实施指南.md获取详细信息

## 常见问题

- **Q: 程序无法启动，提示Python未安装**  
  A: 请安装Python 3.6或更高版本，并确保将Python添加到系统PATH环境变量

- **Q: 高级编辑器功能不可用**  
  A: 检查是否正确安装了所有必要的Python库，或尝试重新启动程序

- **Q: 生成的代码无法在FPGA上运行**  
  A: 检查代码是否与目标FPGA平台兼容，可能需要针对特定平台进行修改

- **Q: 如何创建自定义设备类型**  
  A: 在"新建配置"选项卡中选择"自定义设备"，然后填写设备详细信息

## 技术支持

如有任何问题或建议，请参考PCIe设备完全伪装实施指南.md文档或联系开发团队。

---

版权所有 © 2023 PCIe设备伪装工具开发团队 